from fbchat import Client, log
from fbchat.models import *
import scrapy

import selenium
from selenium import webdriver
import time
from selenium.webdriver.common.keys import Keys
closest_distance_dict = {'Stony Brook University, NY': 'Driving distance: 65.34 miles , 105.16 kilometers (km) , 345012 feet , 105160 meters', 'Dutchess Stadium, 1500 NY-9D': 'Driving distance: 55.98 miles , 90.09 kilometers (km) , 295569 feet , 90089 meters', '300 Enterprise Drive, NY, 12401': 'Driving distance: 86.61 miles , 139.38 kilometers (km) , 457276 feet , 139378 meters', '462 1st Avenue, New York, NY 10016': 'Driving distance: 24.36 miles , 39.21 kilometers (km) , 128629 feet , 39206 meters', '79-01 Broadway, New York': 'Driving distance: 22.97 miles , 36.97 kilometers (km) , 121287 feet , 36968 meters', '506 Lenox Avenue, New York, NY': 'Driving distance: 16.82 miles , 27.08 kilometers (km) , 88829 feet , 27075 meters', '1901 1st Avenue, New York, NY 10029': 'Driving distance: 20.15 miles , 32.43 kilometers (km) , 106412 feet , 32434 meters', '451 Clarkson Avenue, Brooklyn, NY': 'Driving distance: 32.53 miles , 52.35 kilometers (km) , 171738 feet , 52346 meters', '234 East 149th Street, Bronx, NY': 'Driving distance: 16.80 miles , 27.04 kilometers (km) , 88723 feet , 27043 meters', '760 Broadway, Brooklyn, NY': 'Driving distance: 27.84 miles , 44.80 kilometers (km) , 146985 feet , 44801 meters', '82-68 164th Street, Jamaica, NY': 'Driving distance: 28.31 miles , 45.56 kilometers (km) , 149491 feet , 45565 meters', '2601 Ocean Parkway, Brooklyn, NY': 'Driving distance: 38.34 miles , 61.71 kilometers (km) , 202448 feet , 61706 meters', '1400 Pelham Parkway South, Bronx, NY': 'Driving distance: 15.52 miles , 24.98 kilometers (km) , 81942 feet , 24976 meters', '1225 Gerard Avenue, Bronx, NY': 'Driving distance: 16.17 miles , 26.02 kilometers (km) , 85372 feet , 26021 meters', '545 East 142nd Street, Bronx, NY': 'Driving distance: 17.32 miles , 27.87 kilometers (km) , 91429 feet , 27868 meters', '100 North Portland Avenue, Brooklyn, NY': 'Driving distance: 27.06 miles , 43.54 kilometers (km) , 142851 feet , 43541 meters', '2094 Pitkin Avenue, Brooklyn, NY': 'Driving distance: 30.75 miles , 49.48 kilometers (km) , 162346 feet , 49483 meters', '227 Madison Street, New York, NY': 'Driving distance: 26.33 miles , 42.37 kilometers (km) , 139009 feet , 42370 meters', '264 West 118th Street, New York, NY': 'Driving distance: 18.02 miles , 29.00 kilometers (km) , 95158 feet , 29004 meters', '165 Vanderbilt Avenue, Staten Island, NY': 'Driving distance: 36.70 miles , 59.06 kilometers (km) , 193772 feet , 59062 meters', 'Palisades Parkway, NY': 'Driving distance: 13.10 miles , 21.09 kilometers (km) , 69179 feet , 21086 meters', 'Weyman Ave, New Rochelle, NY': 'Driving distance: 14.39 miles , 23.15 kilometers (km) , 75967 feet , 23155 meters', '1 Ocean Pkwy, New York': 'Driving distance: 59.53 miles , 95.81 kilometers (km) , 314332 feet , 95808 meters', '555 N. Broadway, New York': 'Driving distance: 55.20 miles , 88.83 kilometers (km) , 291443 feet , 88832 meters', '3 Delaware Drive, Lake Success, NY': 'Driving distance: 28.51 miles , 45.88 kilometers (km) , 150520 feet , 45879 meters', '10033 4th Ave. Brooklyn, NY': 'Driving distance: 30.14 miles , 48.51 kilometers (km) , 159156 feet , 48511 meters', '291 3rd Ave. New York': 'Driving distance: 28.93 miles , 46.55 kilometers (km) , 152724 feet , 46550 meters', '254-61 Nassau Blvd. Queens, NY': 'Driving distance: 26.05 miles , 41.93 kilometers (km) , 137555 feet , 41927 meters', '1149 Old Country Road, Riverhead, NY': 'Driving distance: 84.48 miles , 135.96 kilometers (km) , 446078 feet , 135965 meters', '1167 Wantagh Ave. Wantagh, NY': 'Driving distance: 45.14 miles , 72.64 kilometers (km) , 238336 feet , 72645 meters', '1601 3rd Ave. New York': 'Driving distance: 20.83 miles , 33.53 kilometers (km) , 110003 feet , 33529 meters', '147 Lake St, Newburgh, NY': 'Driving distance: 46.98 miles , 75.61 kilometers (km) , 248069 feet , 75611 meters', '1400 Pelham Parkway South Bronx, New York 10461': 'Driving distance: 15.52 miles , 24.98 kilometers (km) , 81942 feet , 24976 meters', '545 East 142nd Street Bronx, New York 10454': 'Driving distance: 17.32 miles , 27.87 kilometers (km) , 91429 feet , 27868 meters', '30 Hamilton St, Dobbs Ferry, NY 10522': 'Driving distance: 1.45 miles , 2.33 kilometers (km) , 7643 feet , 2330 meters', '2393 Central Park Ave, Yonkers, NY 10710': 'Driving distance: 9.40 miles , 15.13 kilometers (km) , 49635 feet , 15129 meters', '2290 Central Park Ave, Yonkers, NY 10710': 'Driving distance: 9.40 miles , 15.13 kilometers (km) , 49635 feet , 15129 meters', '555 S Broadway, Tarrytown, NY 10591': 'Driving distance: 3.15 miles , 5.07 kilometers (km) , 16647 feet , 5074 meters', '650 White Plains Rd, Tarrytown, NY 10591': 'Driving distance: 4.89 miles , 7.87 kilometers (km) , 25825 feet , 7871 meters', '155 White Plains Rd, Tarrytown, New York': 'Driving distance: 4.17 miles , 6.71 kilometers (km) , 22019 feet , 6711 meters', '269A Livingston St, Northvale, NJ 07647': 'Driving distance: 13.04 miles , 20.99 kilometers (km) , 68861 feet , 20989 meters', '305 N Central Ave, Hartsdale, NY 10530': 'Driving distance: 4.40 miles , 7.08 kilometers (km) , 23238 feet , 7083 meters', '359 N Central Ave, Hartsdale, NY 10530': 'Driving distance: 5.11 miles , 8.23 kilometers (km) , 26986 feet , 8225 meters', '2 Park Ave, Yonkers, NY 10703': 'Driving distance: 7.79 miles , 12.53 kilometers (km) , 41107 feet , 12529 meters', '259 Heathcote Rd, Scarsdale, NY 10583': 'Driving distance: 6.24 miles , 10.04 kilometers (km) , 32942 feet , 10041 meters', '41 E Post Rd, White Plains, NY 10601': 'Driving distance: 9.38 miles , 15.10 kilometers (km) , 49532 feet , 15097 meters', '222 Mamaroneck Ave, White Plains, NY 10605': 'Driving distance: 10.58 miles , 17.02 kilometers (km) , 55855 feet , 17024 meters', '280 Mamaroneck Ave, White Plains, NY 10605': 'Driving distance: 10.67 miles , 17.17 kilometers (km) , 56342 feet , 17173 meters', '7-11 S Broadway, White Plains, NY 10601': 'Driving distance: 9.45 miles , 15.20 kilometers (km) , 49882 feet , 15204 meters', '100 Woods Rd, Valhalla, New York': 'Driving distance: 8.56 miles , 13.78 kilometers (km) , 45202 feet , 13778 meters', '77 Quaker Ridge Rd Ste 4, New Rochelle, NY': 'Driving distance: 12.56 miles , 20.21 kilometers (km) , 66316 feet , 20213 meters', '203 Gramatan Ave, Mt Vernon, NY': 'Driving distance: 9.37 miles , 15.08 kilometers (km) , 49474 feet , 15080 meters', '500 Westchester Ave, West Harrison, NY 10604': 'Driving distance: 10.89 miles , 17.52 kilometers (km) , 57483 feet , 17521 meters'}
nearest_center_tuples = []


def driving_distance(add1, add2):
    PATH = "/Users/martinmashalov/Desktop/chromedriver"
    driver = webdriver.Chrome(PATH)
    driver.get("https://www.mapdevelopers.com/distance_from_to.php")

    address1 = driver.find_element_by_id("fromInput")
    address2 = driver.find_element_by_id("toInput")

    address1.send_keys(add1)


    for address in add2:
        address2.clear()
        address2.send_keys(address)

        button = driver.find_element_by_class_name("link_button").click()
        time.sleep(2.5)

        driving_distance = driver.find_element_by_id("driving_status")
        driving_distance_text = driving_distance.text
        closest_distance_dict[address] = driving_distance_text
        #print(str(address) + "       " + str(driving_distance_text))
        #closest_distance_dict[address] = driving_distance.text
    print(closest_distance_dict)
    driver.quit()
    #return closest_distance_dict

def process_distance():
    counter = 86.6
    optimal_location = ' '
    for location, value in closest_distance_dict.items():
        miles = float(''.join(list(value)[18:22]))
        nearest_center_tuples.append((miles, location))
    nearest_center_tuples.sort()
    for i in nearest_center_tuples[0:5]:
        print(i)


add1 = "10523"
add2 = ['Stony Brook University, NY', 'Dutchess Stadium, 1500 NY-9D', '300 Enterprise Drive, NY, 12401', '462 1st Avenue, New York, NY 10016', '79-01 Broadway, New York', '506 Lenox Avenue, New York, NY', '1901 1st Avenue, New York, NY 10029', '451 Clarkson Avenue, Brooklyn, NY', '234 East 149th Street, Bronx, NY', '760 Broadway, Brooklyn, NY', '82-68 164th Street, Jamaica, NY', '2601 Ocean Parkway, Brooklyn, NY', '1400 Pelham Parkway South, Bronx, NY', '1225 Gerard Avenue, Bronx, NY', '545 East 142nd Street, Bronx, NY', '100 North Portland Avenue, Brooklyn, NY', '2094 Pitkin Avenue, Brooklyn, NY', '227 Madison Street, New York, NY', '264 West 118th Street, New York, NY', '165 Vanderbilt Avenue, Staten Island, NY', 'Palisades Parkway, NY', 'Weyman Ave, New Rochelle, NY', '1 Ocean Pkwy, New York', '555 N. Broadway, New York', '3 Delaware Drive, Lake Success, NY', '10033 4th Ave. Brooklyn, NY', '291 3rd Ave. New York', '254-61 Nassau Blvd. Queens, NY', '1149 Old Country Road, Riverhead, NY', '1167 Wantagh Ave. Wantagh, NY', '1601 3rd Ave. New York', '147 Lake St, Newburgh, NY', '1400 Pelham Parkway South Bronx, New York 10461', '545 East 142nd Street Bronx, New York 10454', '30 Hamilton St, Dobbs Ferry, NY 10522', '2393 Central Park Ave, Yonkers, NY 10710', '2290 Central Park Ave, Yonkers, NY 10710', '555 S Broadway, Tarrytown, NY 10591', '650 White Plains Rd, Tarrytown, NY 10591', '155 White Plains Rd, Tarrytown, New York', '269A Livingston St, Northvale, NJ 07647', '305 N Central Ave, Hartsdale, NY 10530', '359 N Central Ave, Hartsdale, NY 10530', '2 Park Ave, Yonkers, NY 10703', '259 Heathcote Rd, Scarsdale, NY 10583', '41 E Post Rd, White Plains, NY 10601', '222 Mamaroneck Ave, White Plains, NY 10605', '280 Mamaroneck Ave, White Plains, NY 10605', '7-11 S Broadway, White Plains, NY 10601', '100 Woods Rd, Valhalla, New York', '77 Quaker Ridge Rd Ste 4, New Rochelle, NY', '203 Gramatan Ave, Mt Vernon, NY', '500 Westchester Ave, West Harrison, NY 10604']
driving_distance(add1, add2)
process_distance()
#['Stony Brook University, NY', 'Dutchess Stadium, 1500 NY-9D', '300 Enterprise Drive', '462 First Avenue, New York, NY', '79-01 Broadway, New York', '506 Lenox Avenue, New York, NY', '1901 First Avenue, New York, NY', '451 Clarkson Avenue, Brooklyn, NY', '234 East 149th Street, Bronx, NY', '760 Broadway, Brooklyn, NY', '82-68 164th Street, Jamaica, NY', '2601 Ocean Parkway, Brooklyn, NY', '1400 Pelham Parkway South, Bronx, NY', '1225 Gerard Avenue, Bronx, NY', '545 East 142nd Street, Bronx, NY', '100 North Portland Avenue, Brooklyn, NY', '2094 Pitkin Avenue, Brooklyn, NY', '227 Madison Street, New York, NY', '264 West 118th Street, New York, NY', '165 Vanderbilt Avenue, Staten Island, NY', 'Palisades Parkway, NY', 'Weyman Ave, New Rochelle, NY', '1 Ocean Pkwy, New York', '555 N. Broadway, New York', '3 Delaware Drive, Lake Success, NY', '10033 4th Ave. Brooklyn, NY', '291 3rd Ave. New York', '254-61 Nassau Blvd. Queens, NY', '1149 Old Country Road, Riverhead, NY', '1167 Wantagh Ave. Wantagh, NY', '1601 3rd Ave. New York', '147 Lake St, Newburgh, NY', '1400 Pelham Parkway South Bronx, New York 10461', '545 East 142nd Street Bronx, New York 10454', '30 Hamilton St, Dobbs Ferry, NY 10522', '2393 Central Park Ave, Yonkers, NY 10710', '2290 Central Park Ave, Yonkers, NY 10710', '555 S Broadway, Tarrytown, NY 10591', '650 White Plains Rd, Tarrytown, NY 10591', '155 White Plains Rd, Tarrytown, New York', '269A Livingston St, Northvale, NJ 07647', '305 N Central Ave, Hartsdale, NY 10530', '359 N Central Ave, Hartsdale, NY 10530', '2 Park Ave, Yonkers, NY 10703', '259 Heathcote Rd, Scarsdale, NY 10583', '41 E Post Rd, White Plains, NY 10601', '222 Mamaroneck Ave, White Plains, NY 10605', '280 Mamaroneck Ave, White Plains, NY 10605', '7-11 S Broadway, White Plains, NY 10601', '100 Woods Rd, Valhalla, New York', '77 Quaker Ridge Rd Ste 4, New Rochelle, NY', '203 Gramatan Ave, Mt Vernon, NY', '500 Westchester Ave, West Harrison, NY 10604']
